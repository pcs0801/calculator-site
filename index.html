
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ÏµúÏ¢Ö Í≥ÑÏÇ∞Í∏∞ (Í∏∞Îä• + ÌÖåÎßà)</title>
  <style>
    :root {
      --bg-color: #1e1e1e;
      --text-color: white;
      --btn-operator-color: #0078d7;
      --btn-number-color: #3d3d3d;
      --btn-hover-color: #5a5a5a;
      --calculator-bg: #2d2d2d;
    }

    body.light-mode {
      --bg-color: #f5f5f5;
      --text-color: #000;
      --btn-operator-color: #f39c12;
      --btn-number-color: #e0e0e0;
      --btn-hover-color: #cfcfcf;
      --calculator-bg: #d1d1d1;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px;
    }

    #controls {
      margin-bottom: 10px;
      text-align: center;
    }

    .toggle-label {
      font-size: 14px;
      margin-bottom: 4px;
    }

    .toggle-icons {
      display: flex;
      border: 1px solid #ccc;
      border-radius: 20px;
      overflow: hidden;
      width: 80px;
      height: 32px;
    }

    .toggle-icons button {
      background-color: transparent;
      border: none;
      width: 50%;
      height: 100%;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .toggle-icons img {
      width: 20px;
      height: 20px;
    }

    .light-mode #lightBtn {
      background-color: #ffffff;
    }

    .light-mode #darkBtn img {
      filter: grayscale(100%);
    }

    body:not(.light-mode) #darkBtn {
      background-color: #3a3a3a;
    }

    body:not(.light-mode) #darkBtn img {
      filter: none;
    }

    body:not(.light-mode) #lightBtn img {
      filter: grayscale(100%);
    }

    .container {
      display: flex;
      gap: 20px;
      margin-top: 10px;
    }

    .calculator {
      background-color: var(--calculator-bg);
      padding: 20px;
      border-radius: 10px;
      width: 360px;
      height: auto;
    }

    .display {
      background-color: var(--bg-color);
      padding: 15px;
      font-size: 32px;
      text-align: right;
      border: none;
      color: var(--text-color);
      width: 100%;
      margin-bottom: 10px;
      border-radius: 5px;
      box-sizing: border-box;
    }

    .buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 4px;
    }

    button {
      padding: 14px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
      height: 50px;
      box-sizing: border-box;
    }

    .btn-number {
      background-color: var(--btn-number-color);
      color: var(--text-color);
    }

    .btn-number:hover {
      background-color: var(--btn-hover-color);
    }

    .btn-operator {
      background-color: var(--btn-operator-color);
      color: white;
    }

    .btn-operator:hover {
      filter: brightness(0.9);
    }

    .side-panel {
      display: flex;
      flex-direction: column;
      gap: 20px;
      min-width: 200px;
      resize: none;
      overflow: auto;
    }

    .panel-box {
      background-color: var(--calculator-bg);
      border-radius: 10px;
      padding: 15px;
      flex-grow: 1;
      min-height: 200px;
     max-height: 220px;   overflow-y: auto; }

    .panel-box h3 {
      margin-top: 0;
      font-size: 1em;
      margin-bottom: 10px;
    }

    ul { list-style: none; padding-left: 10px; max-height: none; overflow: hidden; font-size: 0.9em; }

    .history-item {
      margin-bottom: 10px;
      cursor: pointer;
    }

    .history-item:hover {
      background-color: var(--btn-hover-color);
      border-radius: 5px;
    }

    .light-mode .history-formula {
      color: #555;
    }
    .history-formula {
      color: #aaa;
    }

    .history-result {
      font-weight: bold;
      font-size: 1.1em;
    }
  
  
  
  
  
  
  
  
  
  .copy-icon {
    position: absolute;
    top: 120px;
    right: 275px;
    font-size: 16px;
    background: transparent;
    border: none;
    cursor: pointer;
    color: var(--text-color);
    opacity: 0.7;
    z-index: 10;
  }
  .copy-icon:hover {
    opacity: 1;
    filter: brightness(1.3);
  }










  #languageToggle {
    z-index: 1000;
  }

</style>
</head>
<body class="light-mode">

<div id="controls">
  <div class="toggle-label">ÌôîÎ©¥ ÌÖåÎßà ÏÑ§Ï†ï</div>
  <div class="toggle-icons">
    <button id="lightBtn" onclick="setTheme('light')">
      <img src="https://img.icons8.com/emoji/48/sun-emoji.png" alt="Sun">
    </button>
    <button id="darkBtn" onclick="setTheme('dark')">
      <img src="https://img.icons8.com/emoji/48/crescent-moon-emoji.png" alt="Moon">
    </button>
  </div>
</div>

<div class="container">
  <div class="calculator">
    <input type="text" id="display" class="display" onclick="copyDisplayText()" style="user-select: all; cursor: text;" readonly>
<button onclick="copyDisplayText()" class="copy-icon" title="Í≤∞Í≥ºÍ∞í Î≥µÏÇ¨">üìã</button>

    <div class="buttons" id="buttons"></div>
  </div>

  <div class="side-panel">
    <div class="panel-box">
      <h3>Í∏∞Î°ù</h3>
      <ul id="historyList"></ul>
    </div>
    <div class="panel-box">
      <h3>Î©îÎ™®Î¶¨</h3>
      <ul id="memoryList"></ul>
    </div>
  </div>
</div>

<script>
  const display = document.getElementById("display");
  const historyList = document.getElementById("historyList");
  const memoryList = document.getElementById("memoryList");
  let currentValue = "";
  let memory = 0;

  const symbols = { "√ó": "*", "√∑": "/", "+": "+", "-": "-" };

  function setTheme(mode) {
    document.body.classList.toggle("light-mode", mode === "light");
  }

  function formatNumber(val) {
    if (isNaN(val)) return val;
    const [intPart, decPart] = val.toString().split(".");
    const formatted = intPart.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    return decPart ? formatted + "." + decPart : formatted;
  }

  function updateDisplay(value) {
    currentValue = value.toString().replace(/,/g, "");
    display.value = formatNumber(currentValue);
  }

  function press(val) {
    if (val === "‚àö") updateDisplay(Math.sqrt(parseFloat(currentValue) || 0));
    else if (val === "x¬≤") updateDisplay(Math.pow(parseFloat(currentValue) || 0, 2));
    else if (val === "1/x") updateDisplay(1 / (parseFloat(currentValue) || 1));
    else if (val === "+/-") updateDisplay((parseFloat(currentValue || "0") * -1).toString());
    else {
      currentValue += val;
      updateDisplay(currentValue);
      currentValue = display.value.replace(/,/g, '');
    }
  }

  function calculate() {
    try {
      let expr = currentValue;
      for (const key in symbols) expr = expr.split(key).join(symbols[key]);
      const result = eval(expr);
      const formatted = formatNumber(result);
      const li = document.createElement("li");
      li.className = "history-item";
      li.innerHTML = `<div class="history-formula">${currentValue.replace(/([+\-√ó√∑])/g, " $1 ")} =</div><div class="history-result">${formatted}</div>`;
      li.onclick = () => updateDisplay(result);
      historyList.insertBefore(li, historyList.firstChild);
      updateDisplay(result);
    } catch {
      updateDisplay(langData[currentLang].error);
    }
  }

  function clearAll() { updateDisplay(""); }
  function clearEntry() { updateDisplay(""); }
  function backspace() {
    currentValue = currentValue.trim().slice(0, -1);
    updateDisplay(currentValue);
    updateDisplay(currentValue);
  }
  function memClear() { memory = 0; memoryList.innerHTML = ""; }
  function memRecall() { updateDisplay(currentValue + memory.toString()); }
  function memAdd() { memory += parseFloat(currentValue) || 0; memoryList.innerHTML += `<li>+ ${formatNumber(currentValue)}</li>`; }
  function memSub() { memory -= parseFloat(currentValue) || 0; memoryList.innerHTML += `<li>- ${formatNumber(currentValue)}</li>`; }

  document.addEventListener("keydown", (e) => {
    const key = e.key;
    if (!isNaN(key) || ["+", "-", "*", "/", "."].includes(key)) {
      const symbol = key.replace("*", "√ó").replace("/", "√∑");
      press(symbol);
    } else if (key === "Enter") calculate();
    else if (key === "Backspace") backspace();
    else if (key.toLowerCase() === "c") clearAll();
  });

  const buttonMap = [
    ["MC", "MR", "M+", "M-"],
    ["%", "CE", "C", "‚å´"],
    ["1/x", "x¬≤", "‚àö", "√∑"],
    ["7", "8", "9", "√ó"],
    ["4", "5", "6", "-"],
    ["1", "2", "3", "+"],
    ["+/-", "0", ".", "="]
  ];

  const buttonContainer = document.getElementById("buttons");
  buttonMap.forEach(row =>
    row.forEach(text => {
      const btn = document.createElement("button");
      btn.textContent = text;
      btn.className = isNaN(text) && ![".", "+/-", "="].includes(text) ? "btn-operator" : "btn-number";
      if (text === "=") { btn.onclick = calculate; btn.className = "btn-operator"; }
      else if (text === "C") btn.onclick = clearAll;
      else if (text === "CE") btn.onclick = clearEntry;
      else if (text === "‚å´") btn.onclick = backspace;
      else if (text === "MC") btn.onclick = memClear;
      else if (text === "MR") btn.onclick = memRecall;
      else if (text === "M+") btn.onclick = memAdd;
      else if (text === "M-") btn.onclick = memSub;
      else btn.onclick = () => press(text);
      buttonContainer.appendChild(btn);
    })
  );

function copyDisplayText() {
  navigator.clipboard.writeText(display.value).then(() => {
    console.log("Copied to clipboard");
  }).catch(err => {
    console.error("Copy failed", err);
  });
}


document.querySelector(".display").addEventListener("copy", function (e) {
  e.clipboardData.setData("text/plain", display.value);
  e.preventDefault(); // prevent default copy behavior that might interfere
});


let currentLang = 'ko';
const langData = {
  ko: {
    record: 'Í∏∞Î°ù',
    memory: 'Î©îÎ™®Î¶¨',
    theme: 'ÌôîÎ©¥ ÌÖåÎßà ÏÑ§Ï†ï',
    error: 'Ïò§Î•ò',
    buttons: {
      "Í≤∞Í≥ºÍ∞í Î≥µÏÇ¨": "Í≤∞Í≥ºÍ∞í Î≥µÏÇ¨",
    }
  },
  en: {
    record: 'History',
    memory: 'Memory',
    theme: 'Theme Mode',
    error: 'Error',
    buttons: {
      "Í≤∞Í≥ºÍ∞í Î≥µÏÇ¨": "Copy Result"
    }
  }
};

function toggleLanguage() {
  currentLang = currentLang === 'ko' ? 'en' : 'ko';
  document.getElementById('langText').innerText = currentLang === 'ko' ? 'KO' : 'EN';
  document.querySelector('.panel-box h3').innerText = langData[currentLang].record;
  document.querySelectorAll('.panel-box h3')[1].innerText = langData[currentLang].memory;
  document.querySelector('.toggle-label').innerText = langData[currentLang].theme;

  document.querySelectorAll('button').forEach(btn => {
    const label = btn.innerText.trim();
    for (const [ko, en] of Object.entries(langData.ko.buttons)) {
      if (label === ko || label === langData.en.buttons[ko]) {
        btn.innerText = langData[currentLang].buttons[ko];
      }
    }
  });
}

</script>
</body>
</html>
